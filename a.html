<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mood Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 min-h-screen flex flex-col items-center p-6">
    <div class="bg-white p-6 rounded-lg shadow-md w-full max-w-md">
      <h1 class="text-xl font-bold mb-4">Daily Mood Tracker</h1>
      <input
        type="date"
        id="mood-date"
        class="mb-4 p-2 border rounded w-full"
      />
      <div id="mood-options" class="flex justify-around mb-4">
        <button class="mood-btn text-3xl" data-mood="😊">😊</button>
        <button class="mood-btn text-3xl" data-mood="😢">😢</button>
        <button class="mood-btn text-3xl" data-mood="😐">😐</button>
        <button class="mood-btn text-3xl" data-mood="🤩">🤩</button>
      </div>
      <button
        id="save-mood"
        class="bg-blue-500 text-white py-2 px-4 rounded w-full"
      >
        Save Mood
      </button>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-md w-full max-w-md mt-6">
      <h2 class="text-lg font-semibold mb-4">Mood History</h2>
      <select id="filter" class="mb-4 p-2 border rounded w-full">
        <option value="day">Daily</option>
        <option value="week">Weekly</option>
        <option value="month">Monthly</option>
      </select>
      <ul id="mood-history" class="space-y-2 text-center"></ul>
    </div>

    <div class="bg-white p-6 rounded-lg shadow-md w-full max-w-md mt-6">
      <h2 class="text-lg font-semibold mb-4">Calendar View</h2>
      <div class="flex justify-between items-center mb-4">
        <button id="prev-month" class="bg-gray-300 px-2 py-1 rounded">◀</button>
        <span id="current-month" class="text-lg font-semibold"></span>
        <button id="next-month" class="bg-gray-300 px-2 py-1 rounded">▶</button>
      </div>
      <div id="calendar" class="grid grid-cols-7 gap-2"></div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const moodButtons = document.querySelectorAll(".mood-btn");
        const saveButton = document.getElementById("save-mood");
        const moodHistory = document.getElementById("mood-history");
        const filter = document.getElementById("filter");
        const calendar = document.getElementById("calendar");
        const moodDate = document.getElementById("mood-date");
        const prevMonthBtn = document.getElementById("prev-month");
        const nextMonthBtn = document.getElementById("next-month");
        const currentMonthDisplay = document.getElementById("current-month");
        let selectedMood = null;
        let currentDate = new Date();

        moodDate.valueAsDate = new Date();

        moodButtons.forEach((button) => {
          button.addEventListener("click", function () {
            selectedMood = this.getAttribute("data-mood");
            moodButtons.forEach((btn) =>
              btn.classList.remove("ring-2", "ring-blue-500")
            );
            this.classList.add("ring-2", "ring-blue-500");
          });
        });

        saveButton.addEventListener("click", function () {
          if (!selectedMood) {
            alert("Please select a mood");
            return;
          }
          const selectedDate = moodDate.value;
          let moods = JSON.parse(localStorage.getItem("moods")) || {};
          moods[selectedDate] = selectedMood;
          localStorage.setItem("moods", JSON.stringify(moods));
          displayMoodHistory();
          displayCalendar();
        });

        function displayMoodHistory() {
          const moods = JSON.parse(localStorage.getItem("moods")) || {};
          moodHistory.innerHTML = "";
          const filterValue = filter.value;
          const today = new Date();

          Object.keys(moods).forEach((date) => {
            const moodDate = new Date(date);
            let shouldDisplay = false;

            if (filterValue === "day") {
              shouldDisplay = date === today.toISOString().split("T")[0];
            } else if (filterValue === "week") {
              const oneWeekAgo = new Date();
              oneWeekAgo.setDate(today.getDate() - 7);
              shouldDisplay = moodDate >= oneWeekAgo && moodDate <= today;
            } else if (filterValue === "month") {
              shouldDisplay =
                moodDate.getMonth() === today.getMonth() &&
                moodDate.getFullYear() === today.getFullYear();
            }

            if (shouldDisplay) {
              const li = document.createElement("li");
              li.textContent = `${date}: ${moods[date]}`;
              li.classList.add("bg-gray-200", "p-2", "rounded");
              moodHistory.appendChild(li);
            }
          });
        }

        function displayCalendar() {
          const moods = JSON.parse(localStorage.getItem("moods")) || {};
          calendar.innerHTML = "";
          currentMonthDisplay.textContent = currentDate.toLocaleString(
            "default",
            { month: "long", year: "numeric" }
          );
          let daysInMonth = new Date(
            currentDate.getFullYear(),
            currentDate.getMonth() + 1,
            0
          ).getDate();
          for (let i = 1; i <= daysInMonth; i++) {
            let day = i.toString();
            let date = `${currentDate.getFullYear()}-${(
              currentDate.getMonth() + 1
            )
              .toString()
              .padStart(2, "0")}-${day.padStart(2, "0")}`;
            let mood = moods[date] || "⬜";
            let div = document.createElement("div");
            div.innerHTML = `<span class='text-xs'>${day}</span><br>${mood}`;
            div.classList.add(
              "w-10",
              "h-10",
              "flex",
              "flex-col",
              "items-center",
              "justify-center",
              "border",
              "rounded"
            );
            calendar.appendChild(div);
          }
        }

        prevMonthBtn.addEventListener("click", function () {
          currentDate.setMonth(currentDate.getMonth() - 1);
          displayCalendar();
        });

        nextMonthBtn.addEventListener("click", function () {
          currentDate.setMonth(currentDate.getMonth() + 1);
          displayCalendar();
        });

        filter.addEventListener("change", displayMoodHistory);
        displayMoodHistory();
        displayCalendar();
      });
    </script>
  </body>
</html>
